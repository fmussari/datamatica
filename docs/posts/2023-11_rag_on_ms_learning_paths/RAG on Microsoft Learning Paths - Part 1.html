<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Francisco Mussari">
<meta name="dcterms.date" content="2023-11-15">

<title>datamatica - RAG on Microsoft Learning Paths - Part 1. Web Scraping and Supabase</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">datamatica</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/fmussari" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/francisco-mussari-432b781a6/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">RAG on Microsoft Learning Paths - Part 1. Web Scraping and Supabase</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">RAG</div>
                <div class="quarto-category">LLM</div>
                <div class="quarto-category">Embeddings</div>
                <div class="quarto-category">Power BI</div>
                <div class="quarto-category">SQLAlchemy</div>
                <div class="quarto-category">PostgreSQL</div>
                <div class="quarto-category">Supabase</div>
                <div class="quarto-category">BeautifulSoup</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Francisco Mussari </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 15, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#import-libraries" id="toc-import-libraries" class="nav-link" data-scroll-target="#import-libraries">Import libraries</a></li>
  <li><a href="#credentials" id="toc-credentials" class="nav-link" data-scroll-target="#credentials">Credentials</a></li>
  <li><a href="#data-models-entity-relationship-diagram-erd" id="toc-data-models-entity-relationship-diagram-erd" class="nav-link" data-scroll-target="#data-models-entity-relationship-diagram-erd">Data Model’s Entity Relationship Diagram (ERD)</a></li>
  <li><a href="#creating-the-object-relational-mapping" id="toc-creating-the-object-relational-mapping" class="nav-link" data-scroll-target="#creating-the-object-relational-mapping">Creating the Object Relational Mapping</a></li>
  <li><a href="#start-populating-the-database" id="toc-start-populating-the-database" class="nav-link" data-scroll-target="#start-populating-the-database">Start Populating the Database</a></li>
  <li><a href="#web-scraping" id="toc-web-scraping" class="nav-link" data-scroll-target="#web-scraping">Web Scraping</a>
  <ul class="collapse">
  <li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a></li>
  <li><a href="#getting-data-from-each-learning-path" id="toc-getting-data-from-each-learning-path" class="nav-link" data-scroll-target="#getting-data-from-each-learning-path">Getting Data from each Learning Path</a></li>
  <li><a href="#insert-learning-path-data-into-supabase" id="toc-insert-learning-path-data-into-supabase" class="nav-link" data-scroll-target="#insert-learning-path-data-into-supabase">Insert Learning Path Data into Supabase</a></li>
  <li><a href="#scraping-data-from-each-module" id="toc-scraping-data-from-each-module" class="nav-link" data-scroll-target="#scraping-data-from-each-module">Scraping Data from each Module</a></li>
  <li><a href="#insert-module-data-into-supabase" id="toc-insert-module-data-into-supabase" class="nav-link" data-scroll-target="#insert-module-data-into-supabase">Insert Module Data into Supabase</a></li>
  <li><a href="#getting-chapters-data-from-each-module" id="toc-getting-chapters-data-from-each-module" class="nav-link" data-scroll-target="#getting-chapters-data-from-each-module">Getting Chapter’s Data from each Module</a></li>
  <li><a href="#insert-chapter-data-into-supabase" id="toc-insert-chapter-data-into-supabase" class="nav-link" data-scroll-target="#insert-chapter-data-into-supabase">Insert Chapter Data into Supabase</a></li>
  <li><a href="#getting-questions-from-check-knowledge-chapters" id="toc-getting-questions-from-check-knowledge-chapters" class="nav-link" data-scroll-target="#getting-questions-from-check-knowledge-chapters">Getting Questions from ‘Check Knowledge’ Chapters</a></li>
  <li><a href="#insert-questions-into-supabase" id="toc-insert-questions-into-supabase" class="nav-link" data-scroll-target="#insert-questions-into-supabase">Insert Questions into Supabase</a></li>
  <li><a href="#getting-answers-from-check-knowledge-chapters" id="toc-getting-answers-from-check-knowledge-chapters" class="nav-link" data-scroll-target="#getting-answers-from-check-knowledge-chapters">Getting Answers from ‘Check Knowledge’ Chapters</a></li>
  <li><a href="#insert-answers-into-supabase" id="toc-insert-answers-into-supabase" class="nav-link" data-scroll-target="#insert-answers-into-supabase">Insert Answers into Supabase</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p><strong>Retrieval Augmented Generation</strong> (RAG) provides <strong>Large Language Models</strong> (LLMs) context and access to a knowledge base, leading to more precise answers and fewer hallucinations.</p>
<p>In this blog series we’ll go in a journey with RAG and Microsoft Learning Paths (Power BI) to explore what could be achieved.</p>
<p>First up, let’s tackle the data preparation phase.</p>
<p>In <strong>Part 1</strong> we’ll ditch the idea of starting with a set of pre-processed documents and instead build our own data pipeline from scratch. This involves creating a database model, scraping Microsoft Modules, storing them in Supabase (PostgreSQL), and managing the database using SQLAlchemy Object Relational Mapper (ORM).</p>
<p>Don’t worry if some of these terms are new; you’re not alone!”</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li><a href="https://docs.sqlalchemy.org/en/20/tutorial/index.html#sqlalchemy-unified-tutorial">SQLAlchemy Unified Tutorial</a></li>
<li><a href="https://docs.sqlalchemy.org/en/20/orm/quickstart.html#orm-quick-start">ORM Quick Start</a></li>
</ul>
</section>
<section id="import-libraries" class="level2">
<h2 class="anchored" data-anchor-id="import-libraries">Import libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib.request <span class="im">import</span> Request, urlopen</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup <span class="im">as</span> bs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> Session</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Optional</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> ForeignKey</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> String</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> DeclarativeBase</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> Mapped</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> mapped_column</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> relationship</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> Text, Boolean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="credentials" class="level2">
<h2 class="anchored" data-anchor-id="credentials">Credentials</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>load_dotenv()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>supabase_host <span class="op">=</span> os.environ.get(<span class="st">'SUPABASE_HOST'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>supabase_pass <span class="op">=</span> os.environ.get(<span class="st">'SUPABASE_PASS'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-models-entity-relationship-diagram-erd" class="level2">
<h2 class="anchored" data-anchor-id="data-models-entity-relationship-diagram-erd">Data Model’s Entity Relationship Diagram (ERD)</h2>
<p>Imagine we’re building a roadmap to guide someone’s journey towards becoming a <strong>Microsoft Certified: Power BI Data Analyst Associate</strong>.</p>
<p>The recommended path involves completing a series of <strong>Learning Paths</strong>, each filled with <strong>Modules</strong> containing <strong>Chapters</strong>. Some Chapters might have <strong>Knowledge Checks</strong> to assess your understanding, consisting of single-selection <strong>Questions</strong> with multiple <strong>Answers</strong>, only one of which is correct.</p>
<p>To represent this structure, let’s create a model that looks like this:</p>
<p><img src="ERD.svg" align="center"></p>
<p>Fig 1. Model’s ERD. (Created with https://dbdiagram.io/)</p>
</section>
<section id="creating-the-object-relational-mapping" class="level2">
<h2 class="anchored" data-anchor-id="creating-the-object-relational-mapping">Creating the Object Relational Mapping</h2>
<p>Let’s now move from the diagram to the database itself with SQLAlchemy. We can use the free version of Supabase.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>DB_CONNECTION <span class="op">=</span> <span class="ss">f'postgresql://postgres:</span><span class="sc">{</span>supabase_pass<span class="sc">}</span><span class="ss">@</span><span class="sc">{</span>supabase_host<span class="sc">}</span><span class="ss">:5432/postgres'</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> create_engine(DB_CONNECTION, echo<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Base(DeclarativeBase):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Exam(Base):</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">"exam"</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    code: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    description: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    url: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    learning_paths: Mapped[List[<span class="st">"LearningPath"</span>]] <span class="op">=</span> relationship(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        back_populates<span class="op">=</span><span class="st">"exam"</span>, cascade<span class="op">=</span><span class="st">"all, delete-orphan"</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Exam(code=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>code<span class="sc">!r}</span><span class="ss">, description=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>description<span class="sc">!r}</span><span class="ss">, url=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>url<span class="sc">!r}</span><span class="ss">)"</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LearningPath(Base):</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">"learning_path"</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    title: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    summary: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    url: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    exam_id: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(ForeignKey(<span class="st">"exam.id"</span>))</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    exam: Mapped[<span class="st">"Exam"</span>] <span class="op">=</span> relationship(back_populates<span class="op">=</span><span class="st">"learning_paths"</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    modules: Mapped[List[<span class="st">"Module"</span>]] <span class="op">=</span> relationship(</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        back_populates<span class="op">=</span><span class="st">"learning_path"</span>, cascade<span class="op">=</span><span class="st">"all, delete-orphan"</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"LearningPath(title=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>title<span class="sc">!r}</span><span class="ss">, url=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>url<span class="sc">!r}</span><span class="ss">)"</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Module(Base):</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">"module"</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    title: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    summary: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    url: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    path_id: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(ForeignKey(<span class="st">"learning_path.id"</span>))</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    learning_path: Mapped[<span class="st">"LearningPath"</span>] <span class="op">=</span> relationship(back_populates<span class="op">=</span><span class="st">"modules"</span>)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    chapters: Mapped[List[<span class="st">"Chapter"</span>]] <span class="op">=</span> relationship(</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>        back_populates<span class="op">=</span><span class="st">"module"</span>, cascade<span class="op">=</span><span class="st">"all, delete-orphan"</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Module(title=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>title<span class="sc">!r}</span><span class="ss">, url=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>url<span class="sc">!r}</span><span class="ss">)"</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Chapter(Base):</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">"chapter"</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    title: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    content: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    url: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>    is_check: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Boolean())</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>    module_id: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(ForeignKey(<span class="st">"module.id"</span>))</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>    module: Mapped[<span class="st">"Module"</span>] <span class="op">=</span> relationship(back_populates<span class="op">=</span><span class="st">"chapters"</span>)</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>    questions: Mapped[List[<span class="st">"Question"</span>]] <span class="op">=</span> relationship(</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>        back_populates<span class="op">=</span><span class="st">"chapter"</span>, cascade<span class="op">=</span><span class="st">"all, delete-orphan"</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Chapter(title=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>title<span class="sc">!r}</span><span class="ss">, url=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>url<span class="sc">!r}</span><span class="ss">)"</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Question(Base):</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">"question"</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>    question: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>    chapter_id: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(ForeignKey(<span class="st">"chapter.id"</span>))</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>    chapter: Mapped[<span class="st">"Chapter"</span>] <span class="op">=</span> relationship(back_populates<span class="op">=</span><span class="st">"questions"</span>)</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>    answers: Mapped[List[<span class="st">"Answer"</span>]] <span class="op">=</span> relationship(</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>        back_populates<span class="op">=</span><span class="st">"question"</span>, cascade<span class="op">=</span><span class="st">"all, delete-orphan"</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Question(question=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>question<span class="sc">!r}</span><span class="ss">)"</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Answer(Base):</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">"answer"</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span>: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>    answer: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Text())</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>    is_correct: Mapped[<span class="bu">str</span>] <span class="op">=</span> mapped_column(Boolean())</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>    question_id: Mapped[<span class="bu">int</span>] <span class="op">=</span> mapped_column(ForeignKey(<span class="st">"question.id"</span>))</span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>    question: Mapped[<span class="st">"Question"</span>] <span class="op">=</span> relationship(back_populates<span class="op">=</span><span class="st">"answers"</span>)</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Answer(answer=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>answer<span class="sc">!r}</span><span class="ss">, is_correct=</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>is_correct<span class="sc">!r}</span><span class="ss">)"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete all table if they exists</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Base.metadata.drop_all(engine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create all tables</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Base.metadata.create_all(engine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After executing the previous command, the tables are created in the database:</p>
<p><img src="ERD-pgAdmin.PNG" align="center"></p>
<p>Fig 2. Model’s ERD. (Created with pgAdmin)</p>
</section>
<section id="start-populating-the-database" class="level2">
<h2 class="anchored" data-anchor-id="start-populating-the-database">Start Populating the Database</h2>
<p>We’ll use Python to extract the contents of each web page, but we’ll manually grab the <strong>exam</strong> and <strong>Learning Paths</strong> links. Our case is <strong>Exam PL-300: Microsoft Power BI Data Analyst</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>power_bi_exam <span class="op">=</span> Exam(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    code<span class="op">=</span><span class="st">'PL-300'</span>, description<span class="op">=</span><span class="st">'Microsoft Power BI Data Analyst'</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    url<span class="op">=</span><span class="st">'https://learn.microsoft.com/en-us/credentials/certifications/power-bi-data-analyst-associate/'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>power_bi_exam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Exam(code='PL-300', description='Microsoft Power BI Data Analyst', url='https://learn.microsoft.com/en-us/credentials/certifications/power-bi-data-analyst-associate/')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Session(engine) <span class="im">as</span> session:</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    session.add_all([power_bi_exam])</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    session.commit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="web-scraping" class="level2">
<h2 class="anchored" data-anchor-id="web-scraping">Web Scraping</h2>
<p>Since I couldn’t find a direct way to scrape the main page listing all Learning Paths, let’s start with a list of Learning Paths and work our way from there.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> llama_index <span class="im">import</span> SummaryIndex, SimpleWebPageReader</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>learning_path_path <span class="op">=</span> [</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data-analytics-microsoft/"</span>, <span class="st">"prepare-data-power-bi/"</span>, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"model-data-power-bi/"</span>, <span class="st">"build-power-bi-visuals-reports/"</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"manage-workspaces-datasets-power-bi/"</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>learning_path_base_url <span class="op">=</span> <span class="st">"https://learn.microsoft.com/en-us/training/paths/"</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>module_base_url <span class="op">=</span> <span class="st">"https://learn.microsoft.com/en-us/training/modules/"</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>learning_path_url <span class="op">=</span> [learning_path_base_url <span class="op">+</span> path <span class="cf">for</span> path <span class="kw">in</span> learning_path_path]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>learning_path_url</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['https://learn.microsoft.com/en-us/training/paths/data-analytics-microsoft/',
 'https://learn.microsoft.com/en-us/training/paths/prepare-data-power-bi/',
 'https://learn.microsoft.com/en-us/training/paths/model-data-power-bi/',
 'https://learn.microsoft.com/en-us/training/paths/build-power-bi-visuals-reports/',
 'https://learn.microsoft.com/en-us/training/paths/manage-workspaces-datasets-power-bi/']</code></pre>
</div>
</div>
<section id="functions" class="level3">
<h3 class="anchored" data-anchor-id="functions">Functions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_text_between_regex(text:<span class="bu">str</span>, regex:<span class="bu">str</span><span class="op">=</span><span class="vs">r"\n\n\[ (.*?)\/\)\n\n"</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Matches and extracts text using regular expressions."""</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> re.findall(regex, text)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> matches:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> matches</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_text_from_urls(urls:List[<span class="bu">str</span>], delay:<span class="bu">int</span><span class="op">=</span><span class="dv">5</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Scrapes a list of URLs, introducing pauses, using `SimpleWebPageReader`."""</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> []</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> url <span class="kw">in</span> urls:</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'Scraping </span><span class="sc">{</span>url<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        txt <span class="op">=</span> SimpleWebPageReader(html_to_text<span class="op">=</span><span class="va">True</span>).load_data([url])[<span class="dv">0</span>].text</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        output.append(txt)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        time.sleep(delay) </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> output</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_modules_from_lp(lp_raw_content:List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict:</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Extracts modules' names and paths from Learning Path's scraped content."""</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    modules <span class="op">=</span> {<span class="st">'title'</span>: [], <span class="st">'path'</span>: []}</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> raw_text <span class="kw">in</span> lp_raw_content:</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> raw_text.replace(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="st">""</span>).replace(<span class="st">"[ !"</span>, <span class="st">"[!"</span>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>        paths <span class="op">=</span> get_text_between_regex(text, MOD_URL_REG)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>        names <span class="op">=</span> get_text_between_regex(text, MOD_NAME_REG)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>        names <span class="op">=</span> [</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>            n.strip() <span class="cf">for</span> n <span class="kw">in</span> names <span class="cf">if</span> <span class="st">'Download'</span> <span class="kw">not</span> <span class="kw">in</span> n <span class="kw">and</span> </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'More info'</span> <span class="kw">not</span> <span class="kw">in</span> n <span class="kw">and</span> n <span class="op">!=</span> <span class="st">''</span>]</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>        paths <span class="op">=</span> <span class="bu">list</span>(<span class="bu">dict</span>.fromkeys(paths))</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>        modules[<span class="st">'title'</span>].append(names)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>        modules[<span class="st">'path'</span>].append(paths)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modules</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_chapters_from_mods(mod_content:List[List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> Dict:</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Extracts chapters' names and paths from Modules' scraped content."""</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    chapters <span class="op">=</span> {<span class="st">'title'</span>: [], <span class="st">'path'</span>: []}</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> lp_mods <span class="kw">in</span> mod_content:</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> content <span class="kw">in</span> lp_mods:</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>            chapters_txt <span class="op">=</span> get_text_between_regex(content.replace(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="st">""</span>), CHAPTERS_REG)[<span class="dv">0</span>]</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>            titles <span class="op">=</span> get_text_between_regex(chapters_txt, CHAPTER_TITLE_REG)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>            titles <span class="op">=</span> [t.strip() <span class="cf">for</span> t <span class="kw">in</span> titles]</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>            paths <span class="op">=</span> get_text_between_regex(chapters_txt, CHAPTER_PATH_REG)</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>            paths <span class="op">=</span> [p.strip() <span class="cf">for</span> p <span class="kw">in</span> paths]</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>            chapters[<span class="st">'title'</span>].append(titles)</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>            chapters[<span class="st">'path'</span>].append(paths)</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chapters</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_soup(url:<span class="bu">str</span>) <span class="op">-&gt;</span> <span class="st">'bs4.BeautifulSoup'</span>:</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Fetches the HTML content from a URL and parses it using BeautifulSoup."""</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>    req <span class="op">=</span> Request(url)</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> urlopen(req, timeout<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> bs(response.read())</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> soup</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_questions(soup:<span class="st">'bs4.BeautifulSoup'</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Extracts questions from a BeautifulSoup object representing the HTML content."""</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>    questions <span class="op">=</span> []</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> q <span class="kw">in</span> (</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>        soup</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>        .find_all(class_<span class="op">=</span><span class="st">"field"</span>)[<span class="dv">0</span>]</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>        .find_all(class_<span class="op">=</span><span class="st">"margin-top-sm margin-bottom-xs field-label"</span>)</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>        questions <span class="op">+=</span> q.select(<span class="st">'p'</span>)[<span class="dv">0</span>].contents</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> questions</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_answers(soup:<span class="st">'bs4.BeautifulSoup'</span>) <span class="op">-&gt;</span> List[List]:</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Extracts answers from a BeautifulSoup object representing the HTML content."""</span></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>    all_answers <span class="op">=</span> []</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> answrs <span class="kw">in</span> (</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>        soup</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>        .find_all(class_<span class="op">=</span><span class="st">"field"</span>)[<span class="dv">0</span>]</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>        .find_all(class_<span class="op">=</span><span class="st">"field-body"</span>)</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>        answers <span class="op">=</span> []</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> answr <span class="kw">in</span> (</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>            answrs.find_all(class_<span class="op">=</span><span class="st">"margin-inline-sm radio-label-text"</span>)</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>            answers <span class="op">+=</span> answr.select(<span class="st">'p'</span>)[<span class="dv">0</span>].contents</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>        all_answers.append(answers)</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> all_answers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="getting-data-from-each-learning-path" class="level3">
<h3 class="anchored" data-anchor-id="getting-data-from-each-learning-path">Getting Data from each Learning Path</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>lp_raw_content <span class="op">=</span> get_text_from_urls(learning_path_url, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scraping https://learn.microsoft.com/en-us/training/paths/data-analytics-microsoft/
Scraping https://learn.microsoft.com/en-us/training/paths/prepare-data-power-bi/
Scraping https://learn.microsoft.com/en-us/training/paths/model-data-power-bi/
Scraping https://learn.microsoft.com/en-us/training/paths/build-power-bi-visuals-reports/
Scraping https://learn.microsoft.com/en-us/training/paths/manage-workspaces-datasets-power-bi/</code></pre>
</div>
</div>
<section id="title-of-each-learning-path" class="level4">
<h4 class="anchored" data-anchor-id="title-of-each-learning-path">Title of each Learning Path</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>LP_NAME_REG <span class="op">=</span> <span class="vs">r"\n# (.*?)\n\n"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>lp_title <span class="op">=</span> [get_text_between_regex(txt, LP_NAME_REG)[<span class="dv">0</span>] <span class="cf">for</span> txt <span class="kw">in</span> lp_raw_content]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>lp_title</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['Get started with Microsoft data analytics',
 'Prepare data for analysis with Power BI',
 'Model data with Power BI',
 'Build Power BI visuals and reports',
 'Manage workspaces and datasets in Power BI']</code></pre>
</div>
</div>
</section>
<section id="description-of-each-learning-path" class="level4">
<h4 class="anchored" data-anchor-id="description-of-each-learning-path">Description of each Learning Path</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>LP_DESC_REG <span class="op">=</span> <span class="vs">r"\n\nPower BI\n\n([\s\S]*?)\n\n"</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>lp_desc <span class="op">=</span> [get_text_between_regex(txt, LP_DESC_REG)[<span class="dv">0</span>] <span class="cf">for</span> txt <span class="kw">in</span> lp_raw_content]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- </span><span class="sc">{</span>lp_desc[<span class="dv">0</span>][:<span class="dv">50</span>]<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- </span><span class="sc">{</span>lp_desc[<span class="dv">1</span>][:<span class="dv">50</span>]<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- </span><span class="sc">{</span>lp_desc[<span class="dv">2</span>][:<span class="dv">50</span>]<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- </span><span class="sc">{</span>lp_desc[<span class="dv">3</span>][:<span class="dv">50</span>]<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- </span><span class="sc">{</span>lp_desc[<span class="dv">4</span>][:<span class="dv">50</span>]<span class="sc">}</span><span class="ss">..."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Businesses need data analysis more than ever. In t...
- You'll learn how to use Power Query to extract dat...
- Learn what a Power BI semantic model is, which dat...
- Turn data into interactive, actionable insights wi...
- In this Learning Path, you'll learn how to publish...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>[<span class="bu">len</span>(des) <span class="cf">for</span> des <span class="kw">in</span> lp_desc]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[446, 219, 147, 90, 325]</code></pre>
</div>
</div>
</section>
</section>
<section id="insert-learning-path-data-into-supabase" class="level3">
<h3 class="anchored" data-anchor-id="insert-learning-path-data-into-supabase">Insert Learning Path Data into Supabase</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>lp_to_postgres <span class="op">=</span> [</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    LearningPath(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        exam_id<span class="op">=</span><span class="dv">1</span>, title<span class="op">=</span>title,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        summary<span class="op">=</span>summary, url<span class="op">=</span>url</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="cf">for</span> title, summary, url <span class="kw">in</span> <span class="bu">zip</span>(lp_title, lp_desc, learning_path_url)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>lp_to_postgres[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>LearningPath(title='Get started with Microsoft data analytics', url='https://learn.microsoft.com/en-us/training/paths/data-analytics-microsoft/')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"id: </span><span class="sc">{</span>lp_to_postgres[<span class="dv">0</span>]<span class="sc">.</span><span class="bu">id</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"exam_id: </span><span class="sc">{</span>lp_to_postgres[<span class="dv">0</span>]<span class="sc">.</span>exam_id<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"title: </span><span class="sc">{</span>lp_to_postgres[<span class="dv">0</span>]<span class="sc">.</span>title<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"summary: </span><span class="sc">{</span>lp_to_postgres[<span class="dv">0</span>]<span class="sc">.</span>summary[:<span class="dv">50</span>]<span class="sc">}</span><span class="ss">..."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>id: None
exam_id: 1
title: Get started with Microsoft data analytics
summary: Businesses need data analysis more than ever. In t...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Session(engine) <span class="im">as</span> session:</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    session.add_all(lp_to_postgres)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    session.commit()</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    lp_desc_id <span class="op">=</span> [lp.<span class="bu">id</span> <span class="cf">for</span> lp <span class="kw">in</span> lp_to_postgres]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>lp_desc_id</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[1, 2, 3, 4, 5]</code></pre>
</div>
</div>
<section id="getting-modules-paths-and-titles" class="level4">
<h4 class="anchored" data-anchor-id="getting-modules-paths-and-titles">Getting Modules’ Paths and Titles</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>MOD_URL_REG <span class="op">=</span> <span class="vs">r"\(.*?/modules/(.*?)\)"</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>MOD_NAME_REG <span class="op">=</span> <span class="vs">r"\[ (.*?)\]"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>modules <span class="op">=</span> extract_modules_from_lp(lp_raw_content)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>modules[<span class="st">'title'</span>][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['Discover data analysis', 'Get started building with Power BI']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>modules[<span class="st">'path'</span>][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['data-analytics-microsoft/', 'get-started-with-power-bi/']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>module_base_url</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>modules[<span class="st">'url'</span>] <span class="op">=</span> [[module_base_url <span class="op">+</span> p <span class="cf">for</span> p <span class="kw">in</span> path] <span class="cf">for</span> path <span class="kw">in</span> modules[<span class="st">'path'</span>]]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>modules[<span class="st">'url'</span>][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/',
 'https://learn.microsoft.com/en-us/training/modules/get-started-with-power-bi/']</code></pre>
</div>
</div>
</section>
</section>
<section id="scraping-data-from-each-module" class="level3">
<h3 class="anchored" data-anchor-id="scraping-data-from-each-module">Scraping Data from each Module</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>modules[<span class="st">'content'</span>] <span class="op">=</span> []</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> modules_url <span class="kw">in</span> modules[<span class="st">'url'</span>]:</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    modules[<span class="st">'content'</span>].append(get_text_from_urls(modules_url, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scraping https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/
Scraping https://learn.microsoft.com/en-us/training/modules/get-started-with-power-bi/
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-models/
Scraping https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-calculated-tables/
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-time-intelligence/
Scraping https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/
Scraping https://learn.microsoft.com/en-us/training/modules/enforce-power-bi-model-security/
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/
Scraping https://learn.microsoft.com/en-us/training/modules/create-paginated-reports-power-bi/
Scraping https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/
Scraping https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/
Scraping https://learn.microsoft.com/en-us/training/modules/row-level-security-power-bi/</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>modules[<span class="st">'content'</span>][<span class="dv">3</span>][<span class="dv">0</span>][<span class="dv">600</span>:<span class="dv">1000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'sign requirements\n\n  *   * Module \n  * 8 Units \n\nFeedback\n\nIntermediate\n\nBusiness User\n\nBusiness Analyst\n\nMicrosoft Power Platform\n\nPower BI\n\nGathering appropriate inputs to scope your report design requirements involves\nidentifying your audience, determining the suitable report types, and defining\ntheir interface and experience requirements. This module provides you with a\nstrong foundation on wh'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>m_d_r_1 <span class="op">=</span> <span class="vs">r"\n\nPower BI\n\nMicrosoft Power Platform\n\n"</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>m_d_r_2 <span class="op">=</span> <span class="vs">r"\n\nMicrosoft Power Platform\n\nPower BI\n\n"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>m_d_r_3 <span class="op">=</span> <span class="vs">r"\n\nPower BI\n\n"</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>m_d_r_4 <span class="op">=</span> <span class="vs">r"\n\nMicrosoft Power Platform\n\n"</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>MOD_DESC_REG <span class="op">=</span> <span class="vs">fr"(</span><span class="sc">{</span>m_d_r_1<span class="sc">}</span><span class="vs">|</span><span class="sc">{</span>m_d_r_2<span class="sc">}</span><span class="vs">|</span><span class="sc">{</span>m_d_r_3<span class="sc">}</span><span class="vs">|</span><span class="sc">{</span>m_d_r_4<span class="sc">}</span><span class="vs">)([\s\S]*?)\n\nSave"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>modules[<span class="st">'summary'</span>] <span class="op">=</span> []</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> mod_content <span class="kw">in</span> modules[<span class="st">'content'</span>]:</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    summary <span class="op">=</span> []</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> txt <span class="kw">in</span> mod_content:</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>        summary.append(get_text_between_regex(txt, MOD_DESC_REG)[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    modules[<span class="st">'summary'</span>].append(summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modules[<span class="st">'summary'</span>][<span class="dv">3</span>][<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Gathering appropriate inputs to scope your report design requirements involves
identifying your audience, determining the suitable report types, and defining
their interface and experience requirements. This module provides you with a
strong foundation on which to learn how to plan your report design
requirements.

##  Learning objectives

In this module, you will:

  * Determine business goals.
  * Identify your audience.
  * Determine report types.
  * Define user interface requirements.
  * Define user experience requirements.</code></pre>
</div>
</div>
</section>
<section id="insert-module-data-into-supabase" class="level3">
<h3 class="anchored" data-anchor-id="insert-module-data-into-supabase">Insert Module Data into Supabase</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mod_to_postgres <span class="op">=</span> []</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, path_id <span class="kw">in</span> <span class="bu">enumerate</span>(lp_desc_id):</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> title, summary, url <span class="kw">in</span> <span class="bu">zip</span>(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>        modules[<span class="st">'title'</span>][idx], modules[<span class="st">'summary'</span>][idx], modules[<span class="st">'url'</span>][idx]</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>        mod_to_postgres.append(</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>            Module(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                path_id<span class="op">=</span>path_id, title<span class="op">=</span>title,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                summary<span class="op">=</span>summary, url<span class="op">=</span>url</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Session(engine) <span class="im">as</span> session:</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    session.add_all(mod_to_postgres)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    session.commit()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    mod_id <span class="op">=</span> [mod.<span class="bu">id</span> <span class="cf">for</span> mod <span class="kw">in</span> mod_to_postgres]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mod_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]</code></pre>
</div>
</div>
</section>
<section id="getting-chapters-data-from-each-module" class="level3">
<h3 class="anchored" data-anchor-id="getting-chapters-data-from-each-module">Getting Chapter’s Data from each Module</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>CHAPTERS_REG <span class="op">=</span> <span class="vs">r"\* (\[.*) minTheme"</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>CHAPTER_TITLE_REG <span class="op">=</span> <span class="vs">r"\[(.*?)\]"</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>CHAPTER_PATH_REG <span class="op">=</span> <span class="vs">r"]\((.*?)\)"</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>chapters <span class="op">=</span> extract_chapters_from_mods(modules[<span class="st">'content'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(chapters[<span class="st">'title'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>23</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>base_url <span class="op">=</span> [base <span class="cf">for</span> lp_url <span class="kw">in</span> modules[<span class="st">'url'</span>] <span class="cf">for</span> base <span class="kw">in</span> lp_url]</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>chapters[<span class="st">'url'</span>] <span class="op">=</span> []</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> base, paths <span class="kw">in</span> <span class="bu">zip</span>(base_url, chapters[<span class="st">'path'</span>]):</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    urls <span class="op">=</span> [base <span class="op">+</span> p <span class="cf">for</span> p <span class="kw">in</span> paths]</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    chapters[<span class="st">'url'</span>].append(urls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>chapters[<span class="st">'url'</span>][<span class="dv">20</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/1-introduction',
 'https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/4-power-bi-gateway',
 'https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/5-dataset-refresh',
 'https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/6-incremental-refresh',
 'https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/7-manage-datasets',
 'https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/8-troubleshoot-connectivity',
 'https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/9-query-caching',
 'https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/10-check',
 'https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/11-summary']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>chapters[<span class="st">'content'</span>] <span class="op">=</span> []</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>CHAPTERS_CONTENT_REG <span class="op">=</span> <span class="vs">r"minute[s]?\n\n([\s\S]*)\n\n\[ Continue"</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chapters_url <span class="kw">in</span> chapters[<span class="st">'url'</span>]:</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    raw_content <span class="op">=</span> get_text_from_urls(chapters_url, <span class="dv">8</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    chapter_content <span class="op">=</span> []</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> txt <span class="kw">in</span> raw_content:</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>        chapter_content.append(</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>            get_text_between_regex(txt, CHAPTERS_CONTENT_REG)[<span class="dv">0</span>])</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    chapters[<span class="st">'content'</span>].append(chapter_content)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scraping https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/2-data-analysis
Scraping https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/3-roles
Scraping https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/4-tasks
Scraping https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/5-check
Scraping https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/6-summary
Scraping https://learn.microsoft.com/en-us/training/modules/get-started-with-power-bi/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/get-started-with-power-bi/2-using-power-bi
Scraping https://learn.microsoft.com/en-us/training/modules/get-started-with-power-bi/3-building-blocks-of-power-bi
Scraping https://learn.microsoft.com/en-us/training/modules/get-started-with-power-bi/4-exercise-touring-and-using-power-bi
Scraping https://learn.microsoft.com/en-us/training/modules/get-started-with-power-bi/6-get-started-with-power-bi-quiz
Scraping https://learn.microsoft.com/en-us/training/modules/get-started-with-power-bi/5-summary-cleanup
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/2-data-files
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/3-relational-data
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/3b-parameters
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/4-nosql-database
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/5-online-services
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/6-storage-mode
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/7-azure-analysis-services
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/8-performance-issues
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/9-import-errors
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/lab-prepare
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/10-check
Scraping https://learn.microsoft.com/en-us/training/modules/get-data/11-summary
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/2-shape-data
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/3-data-structure
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/4-column-data-types
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/5-combine-tables
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/6-profile-data
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/7-advanced-editor
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/8-lab
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/9-check
Scraping https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/10-summary
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-models/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-models/2-star-schema-design
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-models/3-analytic-queries
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-models/4-report-visuals
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-models/5-check
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-models/6-summary
Scraping https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/2-describe-power-bi-model-fundamentals
Scraping https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/3-determine-when-to-develop-import-model
Scraping https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/4-determine-when-to-develop-directquery-model
Scraping https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/5-determine-when-to-develop-composite-model
Scraping https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/6-choose-model-framework
Scraping https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/7-knowledge-check
Scraping https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/8-summary
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/2-tables
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/3-date-table
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/4-dimensions
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/5-data-granularity
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/6-relationships-cardinality
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/7-modeling-challenges
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/8-lab
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/10-check
Scraping https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/11-summary
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/2-formulas
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/3-data-types
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/4-functions
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/5-operators
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/6-variables
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/7-check
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/8-summary
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/2-simple-measures
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/3-compound-measures
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/4-quick-measures
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/5-compare-calculated-columns-measures
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/6-check
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/5b-lab
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/7-summary
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-calculated-tables/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-calculated-tables/2-calculated-columns
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-calculated-tables/3-row-context
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-calculated-tables/4-technique
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-calculated-tables/5-check
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-calculated-tables/6-summary
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-time-intelligence/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-time-intelligence/2-functions
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-time-intelligence/3-calculations
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-time-intelligence/3b-lab
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-time-intelligence/4-check
Scraping https://learn.microsoft.com/en-us/training/modules/dax-power-bi-time-intelligence/5-summary
Scraping https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/2-performance
Scraping https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/3-variables
Scraping https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/4-reduce-cardinality
Scraping https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/5-directquery-models
Scraping https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/6-aggregations
Scraping https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/7-check
Scraping https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/8-summary
Scraping https://learn.microsoft.com/en-us/training/modules/enforce-power-bi-model-security/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/enforce-power-bi-model-security/2-restrict-access-to-power-bi-model-data
Scraping https://learn.microsoft.com/en-us/training/modules/enforce-power-bi-model-security/3-restrict-access-to-power-bi-model-objects
Scraping https://learn.microsoft.com/en-us/training/modules/enforce-power-bi-model-security/4-apply-good-modeling-practices
Scraping https://learn.microsoft.com/en-us/training/modules/enforce-power-bi-model-security/4a-exercise-enforce-model-security
Scraping https://learn.microsoft.com/en-us/training/modules/enforce-power-bi-model-security/5-knowledge-check
Scraping https://learn.microsoft.com/en-us/training/modules/enforce-power-bi-model-security/6-summary
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/2-identify
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/3-determine
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/4-define-interface
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/5-define-experience
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/6-explore-designs
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/7-check
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/8-summary
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/2-design-layout
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/3-design-reports
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/4-report-objects
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/5-report-visuals
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/6-visuals-layout
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/7-format
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/8-kpi
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/9-lab
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/10-check
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/11-summary
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/2-report-structure
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/3-slicers
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/4-advanced-filtering
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/5-consumption-time
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/6-filter-techniques
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/7-feedback-configuration
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/8-check
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/9-summary
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/2-design-reports
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/3-design-app-reports
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/4-bookmarks
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/5-design-navigation-reports
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/6-visual-headers
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/7-design-built-in-assistance
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/8-tune-reports
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/9-reports-mobile
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/10-lab
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/11-check
Scraping https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/12-summary
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/2-statistical-summary
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/3-visuals
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/4-group-data
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/5-clustering-techniques
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/6-time-series-analysis
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/7-analyze-feature
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/8-what-if-parameters
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/9-use-specialized-visuals
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/10-lab
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/11-check
Scraping https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/12-summary
Scraping https://learn.microsoft.com/en-us/training/modules/create-paginated-reports-power-bi/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/create-paginated-reports-power-bi/2-get-data
Scraping https://learn.microsoft.com/en-us/training/modules/create-paginated-reports-power-bi/3-paginated-report
Scraping https://learn.microsoft.com/en-us/training/modules/create-paginated-reports-power-bi/4-charts
Scraping https://learn.microsoft.com/en-us/training/modules/create-paginated-reports-power-bi/5-publish
Scraping https://learn.microsoft.com/en-us/training/modules/create-paginated-reports-power-bi/7-check
Scraping https://learn.microsoft.com/en-us/training/modules/create-paginated-reports-power-bi/8-summary
Scraping https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/2-distribute-report-dashboard
Scraping https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/3-monitor-usage-performance
Scraping https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/4-development-lifecycle-strategy
Scraping https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/5-troubleshoot-data
Scraping https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/6-data-protection
Scraping https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/8-check
Scraping https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/9-summary
Scraping https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/4-power-bi-gateway
Scraping https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/5-dataset-refresh
Scraping https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/6-incremental-refresh
Scraping https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/7-manage-datasets
Scraping https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/8-troubleshoot-connectivity
Scraping https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/9-query-caching
Scraping https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/10-check
Scraping https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/11-summary
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/2-data-alerts
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/3-explore-data
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/4-quick-insights
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/5-dashboard-theme
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/6-pin-live-report
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/7-configure-real-time-dashboard
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/8-configure-data-classification
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/9-set-mobile-view
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/10-lab
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/11-check
Scraping https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/12-summary
Scraping https://learn.microsoft.com/en-us/training/modules/row-level-security-power-bi/1-introduction
Scraping https://learn.microsoft.com/en-us/training/modules/row-level-security-power-bi/2-static-method
Scraping https://learn.microsoft.com/en-us/training/modules/row-level-security-power-bi/3-dynamic-method
Scraping https://learn.microsoft.com/en-us/training/modules/row-level-security-power-bi/lab
Scraping https://learn.microsoft.com/en-us/training/modules/row-level-security-power-bi/4-check
Scraping https://learn.microsoft.com/en-us/training/modules/row-level-security-power-bi/5-summary</code></pre>
</div>
</div>
</section>
<section id="insert-chapter-data-into-supabase" class="level3">
<h3 class="anchored" data-anchor-id="insert-chapter-data-into-supabase">Insert Chapter Data into Supabase</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>ch_to_postgres <span class="op">=</span> []</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, m_id <span class="kw">in</span> <span class="bu">enumerate</span>(mod_id):</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> title, content, url <span class="kw">in</span> <span class="bu">zip</span>(</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>        chapters[<span class="st">'title'</span>][idx], chapters[<span class="st">'content'</span>][idx], chapters[<span class="st">'url'</span>][idx]</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>        is_check <span class="op">=</span> <span class="va">False</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'check'</span> <span class="kw">in</span> url <span class="kw">or</span> <span class="st">'quiz'</span> <span class="kw">in</span> url:</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>            is_check <span class="op">=</span> <span class="va">True</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>        ch_to_postgres.append(</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>            Chapter(</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                module_id<span class="op">=</span>m_id, title<span class="op">=</span>title,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                content<span class="op">=</span>content, url<span class="op">=</span>url, is_check<span class="op">=</span>is_check</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(ch_to_postgres))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>ch_to_postgres[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>196</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>Chapter(title='Introduction', url='https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/1-introduction')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Session(engine) <span class="im">as</span> session:</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    session.add_all(ch_to_postgres)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    session.commit()</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    chapter_id <span class="op">=</span> [ch.<span class="bu">id</span> <span class="cf">for</span> ch <span class="kw">in</span> ch_to_postgres]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(chapter_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>196</code></pre>
</div>
</div>
</section>
<section id="getting-questions-from-check-knowledge-chapters" class="level3">
<h3 class="anchored" data-anchor-id="getting-questions-from-check-knowledge-chapters">Getting Questions from ‘Check Knowledge’ Chapters</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>check_chapter <span class="op">=</span> []</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> chapter <span class="kw">in</span> ch_to_postgres:</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> chapter.is_check:</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>        check_chapter.append(chapter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>check_chapter[<span class="dv">0</span>].url</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/5-check'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>questions <span class="op">=</span> []</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ch <span class="kw">in</span> check_chapter:</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Questions from </span><span class="sc">{</span>ch<span class="sc">.</span>url<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> get_soup(ch.url)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    questions.append(get_questions(soup))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Questions from https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/5-check
Questions from https://learn.microsoft.com/en-us/training/modules/get-started-with-power-bi/6-get-started-with-power-bi-quiz
Questions from https://learn.microsoft.com/en-us/training/modules/get-data/10-check
Questions from https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/9-check
Questions from https://learn.microsoft.com/en-us/training/modules/dax-power-bi-models/5-check
Questions from https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/7-knowledge-check
Questions from https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/10-check
Questions from https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/7-check
Questions from https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/6-check
Questions from https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-calculated-tables/5-check
Questions from https://learn.microsoft.com/en-us/training/modules/dax-power-bi-time-intelligence/4-check
Questions from https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/7-check
Questions from https://learn.microsoft.com/en-us/training/modules/enforce-power-bi-model-security/5-knowledge-check
Questions from https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/7-check
Questions from https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/10-check
Questions from https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/8-check
Questions from https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/11-check
Questions from https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/11-check
Questions from https://learn.microsoft.com/en-us/training/modules/create-paginated-reports-power-bi/7-check
Questions from https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/8-check
Questions from https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/10-check
Questions from https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/11-check
Questions from https://learn.microsoft.com/en-us/training/modules/row-level-security-power-bi/4-check</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>questions[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['Which data role enables advanced analytics capabilities specifically through reports and visualizations?',
 'Which data analyst task has a critical performance impact on reporting and data analysis?',
 'Which one of the following options is the most important key benefit of data analysis?']</code></pre>
</div>
</div>
</section>
<section id="insert-questions-into-supabase" class="level3">
<h3 class="anchored" data-anchor-id="insert-questions-into-supabase">Insert Questions into Supabase</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>q_to_postgres <span class="op">=</span> []</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> qs, chapter <span class="kw">in</span> <span class="bu">zip</span>(questions, check_chapter):</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> q <span class="kw">in</span> qs:</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>        q_to_postgres.append(</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>            Question(chapter_id<span class="op">=</span>chapter.<span class="bu">id</span>, question<span class="op">=</span>q)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>q_to_postgres[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Question(question='Which data role enables advanced analytics capabilities specifically through reports and visualizations?')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Session(engine) <span class="im">as</span> session:</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    session.add_all(q_to_postgres)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    session.commit()</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    question_id <span class="op">=</span> [q.<span class="bu">id</span> <span class="cf">for</span> q <span class="kw">in</span> q_to_postgres]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(question_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>69</code></pre>
</div>
</div>
</section>
<section id="getting-answers-from-check-knowledge-chapters" class="level3">
<h3 class="anchored" data-anchor-id="getting-answers-from-check-knowledge-chapters">Getting Answers from ‘Check Knowledge’ Chapters</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>answers <span class="op">=</span> []</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ch <span class="kw">in</span> check_chapter:</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Answers from </span><span class="sc">{</span>ch<span class="sc">.</span>url<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> get_soup(ch.url)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    answers <span class="op">+=</span> get_answers(soup)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Answers from https://learn.microsoft.com/en-us/training/modules/data-analytics-microsoft/5-check
Answers from https://learn.microsoft.com/en-us/training/modules/get-started-with-power-bi/6-get-started-with-power-bi-quiz
Answers from https://learn.microsoft.com/en-us/training/modules/get-data/10-check
Answers from https://learn.microsoft.com/en-us/training/modules/clean-data-power-bi/9-check
Answers from https://learn.microsoft.com/en-us/training/modules/dax-power-bi-models/5-check
Answers from https://learn.microsoft.com/en-us/training/modules/choose-power-bi-model-framework/7-knowledge-check
Answers from https://learn.microsoft.com/en-us/training/modules/design-model-power-bi/10-check
Answers from https://learn.microsoft.com/en-us/training/modules/dax-power-bi-write-formulas/7-check
Answers from https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-measures/6-check
Answers from https://learn.microsoft.com/en-us/training/modules/dax-power-bi-add-calculated-tables/5-check
Answers from https://learn.microsoft.com/en-us/training/modules/dax-power-bi-time-intelligence/4-check
Answers from https://learn.microsoft.com/en-us/training/modules/optimize-model-power-bi/7-check
Answers from https://learn.microsoft.com/en-us/training/modules/enforce-power-bi-model-security/5-knowledge-check
Answers from https://learn.microsoft.com/en-us/training/modules/power-bi-effective-requirements/7-check
Answers from https://learn.microsoft.com/en-us/training/modules/power-bi-effective-reports/10-check
Answers from https://learn.microsoft.com/en-us/training/modules/power-bi-effective-filters/8-check
Answers from https://learn.microsoft.com/en-us/training/modules/power-bi-effective-user-experience/11-check
Answers from https://learn.microsoft.com/en-us/training/modules/perform-analytics-power-bi/11-check
Answers from https://learn.microsoft.com/en-us/training/modules/create-paginated-reports-power-bi/7-check
Answers from https://learn.microsoft.com/en-us/training/modules/create-manage-workspaces-power-bi/8-check
Answers from https://learn.microsoft.com/en-us/training/modules/manage-datasets-power-bi/10-check
Answers from https://learn.microsoft.com/en-us/training/modules/create-dashboards-power-bi/11-check
Answers from https://learn.microsoft.com/en-us/training/modules/row-level-security-power-bi/4-check</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>answers[<span class="dv">0</span>], <span class="bu">len</span>(answers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(['Data scientist', 'Data engineer', 'Data analyst'], 69)</code></pre>
</div>
</div>
</section>
<section id="insert-answers-into-supabase" class="level3">
<h3 class="anchored" data-anchor-id="insert-answers-into-supabase">Insert Answers into Supabase</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>a_to_postgres <span class="op">=</span> []</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q_id, aswrs <span class="kw">in</span> <span class="bu">zip</span>(question_id, answers):</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a <span class="kw">in</span> aswrs:</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>        a_to_postgres.append(</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>            Answer(question_id<span class="op">=</span>q_id, answer<span class="op">=</span>a, is_correct<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>a_to_postgres[<span class="dv">0</span>].question_id, a_to_postgres[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(1, Answer(answer='Data scientist', is_correct=False))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Session(engine) <span class="im">as</span> session:</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    session.add_all(a_to_postgres)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    session.commit()</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    answer_id <span class="op">=</span> [a.<span class="bu">id</span> <span class="cf">for</span> a <span class="kw">in</span> a_to_postgres]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since we don’t have the correct answers readily available, let’s see if our Large Language Models can help us identify them. We can then manually verify the answers against the web for accuracy.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>We’ve got a database model and a free Supabase instance filled with all of Power BI’s Learning Paths.</li>
<li>We started using Beautiful Soup at the end of the scraping process, and it might be worth using it throughout to make the process more generalizable to other Learning Paths.</li>
<li>With our data in order, we’re ready to dive into <strong>Part 2</strong> and start exploring RAG with Large Language Models.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>